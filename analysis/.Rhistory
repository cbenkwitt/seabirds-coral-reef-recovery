#1-sided:
hypothesis(ind_iso_gr_mod, c("Symbiont_N15_cs>0")) #.99
#2-sided:
hypothesis(ind_iso_gr_mod, c("Symbiont_N15_cs=0", #.13*
"Previous_surface_area_cs = 0", #.70
"TypeRTE = 0")) #.72
#extract effect size, exponentiate because log scale: -----
symb_n15_rte_gr_iso_posterior_est<-
ind_iso_gr_mod%>%
gather_draws(b_Symbiont_N15_cs) %>%
median_hdi(.width=c(.9,.95)) %>%
mutate(exp_value = exp(.value),
exp_lower = exp(.lower),
exp_higher = exp(.upper))
symb_n15_rte_gr_iso_posterior_est
#95% HPD: 2.09629	1.144063	3.973096
library(tidyverse)
library(cowplot) #for combining plots
#bayesian analyses:
library(brms)
library(tidybayes)
#extracting effects
library(emmeans)
theme_casey<-
theme_bw()+
theme(panel.grid.major = element_blank(), # remove gridlines
panel.grid.minor = element_blank(), #remove gridlines
strip.background = element_blank(),
#text = element_text(size = 14, family = "Arial"),
rect = element_rect(fill = "transparent"),
plot.background = element_rect(fill = "transparent", color = NA)
)
theme_set(theme_casey)
load("../data/R_data/coral_natural_growth_data.RData")
#growth_dat_diff_r_no0_w_init_size_cs
###set prior-----
nat_gr_prior<-
set_prior("normal(1, .5)", class = "b", coef = "Treatmentrlbirdy")+ #definitely expect positive effect
set_prior("normal(0, 1)", class = "b", coef = "Previous_surface_area_cs")+ #really not sure on this, expect larger colonies to grow more absolute, but smaller proportionally. So go with 0
set_prior("normal(4.6, 1)", class = "Intercept") #based on mean growth from previous studies = 4, along with max and min
###run model-----
natural_growth_mod_log<- brm(
diff_sa_year_log~Treatmentrl + Previous_surface_area_cs + (1|Atoll/Island/ID) + (1|Year),
data = growth_dat_diff_r_no0_w_init_size_cs,
iter = 3000, warmup = 1000, chains = 4, cores = 4,
control = list(adapt_delta = 0.999, max_treedepth = 15),
sample_prior="yes",
prior = nat_gr_prior,
file = "../output/brms/natural_growth_mod_log")
print(natural_growth_mod_log) #0 divergent trans
##check plots----
pp_check(natural_growth_mod_log)
plot(natural_growth_mod_log, ask = FALSE)
##hypothesis testing----
#1-sided:
hypothesis(natural_growth_mod_log, c("Treatmentrlbirdy>0", #0.99
"Previous_surface_area_cs>0")) #1.00
#2-sided:
hypothesis(natural_growth_mod_log, c("Treatmentrlbirdy=0", #0.34*
"Previous_surface_area_cs=0")) #.07*
##extract emmeans----
natural_growth_mod_log.rg <- update(ref_grid(natural_growth_mod_log), tran = "log") #THIS LINE IS CLUTCH*** Now don't have to use link transformations, can use log response and still backtransform with emmeans
natural_growth_mod_log.rg%>%
emmeans("Treatmentrl",
by="Previous_surface_area_cs", #additive model, don't actually need this
type="response")%>%
contrast("revpairwise")
# contrast      ratio lower.HPD upper.HPD
#birdy / ratty  2.37      1.06      4.54
natural_growth_mod_log.rg%>%
emmeans("Treatmentrl",
by=c("Previous_surface_area_cs"), #additive model, don't actually need this
type="response")%>%
contrast("trt.vs.ctrl")
#same as above....
###to report median estimates for each group, on response scale:
natural_growth_mod_log.rg %>%
emmeans(~ Treatmentrl|Previous_surface_area_cs,
type = "response")
#ratty  58.7
#bidy   134.6
natural_growth_group_estimates_plot<-
natural_growth_mod_log %>%
epred_draws(newdata = expand_grid(Treatmentrl = c("birdy", "ratty"),
Previous_surface_area_cs = 0,
reps = 100),
re_formula=NA) %>%
ggplot(aes(x = .epred, color = Treatmentrl, fill = Treatmentrl)) +
stat_slab(point_interval=median_hdi, slab_alpha = .4) + #use relevel only because then blue is on top.
stat_pointinterval(.width=c(.9, .7), position = position_dodge(width = .2, preserve = "single")) +
scale_color_manual(values = c("#0067A5", "#BE0032"),
name = "",
breaks=c("birdy",  "ratty"),
labels=c("seabird", "rat"))+
scale_fill_manual(values = c("#0067A5",  "#BE0032"),
name = "", breaks=c("birdy",  "ratty"),
labels=c("seabird", "rat")
)+ #light blue = #A1CAF1, light red/pink = #F99379, orange = #F38400, purple = #875692
xlab(expression(paste("coral growth rate (log cm"^"2"*"year"^"-1"*")")))+
scale_y_continuous(lim=c(-.15,1), breaks = c(0, .5,  1.0))+
ylab("posterior probability")+
theme_bw() +
theme(panel.grid.major = element_blank(), # remove gridlines
panel.grid.minor = element_blank(), #remove gridlines
strip.background = element_blank(),
legend.position = c(.8, .9),
# legend.title=element_blank(),
rect = element_rect(fill = "transparent"),
plot.background = element_rect(fill = "transparent", color = NA))
natural_growth_group_estimates_plot
#ggsave(filename = "Figures/natural_growth_group_estimates_plot.jpg",
#       plot = natural_growth_group_estimates_plot,
#     width = 5,
#       height = 5,
#     units = "in",
#      dpi = 300)
library(tidyverse)
library(cowplot) #for combining plots
#bayesian analyses:
library(brms)
library(tidybayes)
#extracting effects
library(emmeans)
load("../data/R_data/coral_RTE_growth_data.RData")
#rte_dat_diff_w_init_size_cs
theme_casey<-
theme_bw()+
theme(panel.grid.major = element_blank(), # remove gridlines
panel.grid.minor = element_blank(), #remove gridlines
strip.background = element_blank(),
text = element_text(size = 14, family = "Arial"),
rect = element_rect(fill = "transparent"),
plot.background = element_rect(fill = "transparent", color = NA)
)
theme_set(theme_casey)
###set prior----
rte_gr_prior<-
set_prior("normal(1, .5)", class = "b", coef = "Transplant_treatmentrlbirdy")+ #definitely expect positive effect, approx 4 times, but kept slightly lower so consistent with natural growth models...
set_prior("normal(.5, 1)", class = "b", coef = "Origin_treatmentrlbirdy")+ #origin treatment less sure of - Savage shows very little effect of origin..
set_prior("normal(.5, 1)", class = "b", coef = "Origin_treatmentrlbirdy:Transplant_treatmentrlbirdy")+ #interaction less sure of -  Savage shows very little effect (although maybe slight interaction).
set_prior("normal(0, 1)", class = "b", coef = "Previous_surface_area_cs")+ #really not sure on this, expect larger colonies to grow more absolute, but smaller proportionally. So go with 0
set_prior("normal(4.6, 1)", class = "Intercept") ##max growth from Pratchett (assuming pi*r^2) for Acropora = exp(7.2) (1333 cm/year). mean growth = 4.6 (100)
####run model----
rte_gr_mod_log<- brm(
log(diff_SA_year)~Origin_treatmentrl*Transplant_treatmentrl + Previous_surface_area_cs + (1|Atoll/Origin_colony_unique_ID) + (1|Year),
data = rte_dat_diff_w_init_size_cs,
iter = 3000, warmup = 1000, chains = 4, cores = 4,
control = list(adapt_delta = 0.999, max_treedepth = 15),
prior = rte_gr_prior,
sample_prior="yes",
file = "../output/brms/rte_gr_mod_log")
print(rte_gr_mod_log) #quick and no divergent trans
#looks reasonable
#only effect that doesn't overlap 0 at 95% CI = transplant treatment
##plots to check model:----
pp_check(rte_gr_mod_log)
plot(rte_gr_mod_log, ask = FALSE)
##extract emmeans----
rte_gr_mod_log.rg <- update(ref_grid(rte_gr_mod_log), tran = "log") #THIS LINE IS CLUTCH*** Now don't have to use link transformations, can use log response and still backtransform with emmeans
#compare to rat-rat as reference:
rte_gr_mod_log.rg%>%
emmeans(c("Origin_treatmentrl", "Transplant_treatmentrl"),
type="response")%>%
contrast("trt.vs.ctrl")
# birdy ratty / ratty ratty  1.62      0.55      3.23
# ratty birdy / ratty ratty  2.58      1.47      3.97
# birdy birdy / ratty ratty  2.59      1.22      4.58
#full output for interaction effect:
rte_gr_mod_log.rg%>%
emmeans(c("Origin_treatmentrl", "Transplant_treatmentrl"),
type="response")%>%
contrast("revpairwise")
#averaged over transplant treatment:
rte_gr_mod_log.rg%>%
emmeans("Origin_treatmentrl",
by=c("Previous_surface_area_cs"),
type="response")%>%
contrast("trt.vs.ctrl")
#birdy / ratty  1.28     0.662       2.1
#averaged over origin treatment:
rte_gr_mod_log.rg%>%
emmeans("Transplant_treatmentrl",
by=c("Previous_surface_area_cs"),
type="response")%>%
contrast("trt.vs.ctrl")
# birdy / ratty  2.03      1.17      3.17
###each group:
rte_gr_mod_log.rg%>%
emmeans("Transplant_treatmentrl",
by=c("Origin_treatmentrl", "Previous_surface_area_cs"),
type="response")
# ratty - ratty       33.0
# ratty - birdy       85.4
# birdy - ratty       54.2
# birdy - birdy       85.2
#get estimates
get_variables(rte_gr_mod_log)
rte_gr_mod_log%>%
gather_draws(`b_Origin_treatmentrlbirdy:Transplant_treatmentrlbirdy`) %>%
median_hdi(.width=c(.95))
#trend towards negative interaction, although 95% HDI overlaps 0.
#posterior distributions by group----
#log:
rte_growth_group_estimates_plot<-
rte_gr_mod_log %>%
epred_draws(newdata = expand_grid(Transplant_treatmentrl = c("birdy", "ratty"),
Origin_treatmentrl = c("birdy", "ratty"),
Previous_surface_area_cs = 0,
reps = 100),
re_formula=NA) %>%
mutate(Origin_transplant = str_c(Origin_treatmentrl, Transplant_treatmentrl, sep ="_"))%>%
mutate(Origin_transplant = as.factor(Origin_transplant))%>%
mutate(Origin_transplant = fct_relevel(Origin_transplant, c("birdy_birdy",  "ratty_birdy", "birdy_ratty",  "ratty_ratty")))%>%
mutate(Origin_transplantrl2 = fct_relevel(Origin_transplant, c( "ratty_ratty", "birdy_ratty",  "ratty_birdy","birdy_birdy" )))%>%
mutate(Origin_transplantrl3 = fct_relevel(Origin_transplant, c(  "ratty_birdy",  "birdy_ratty", "ratty_ratty", "birdy_birdy" )))%>%
ggplot(aes(x = .epred, color = Origin_transplant, fill = Origin_transplant)) +
stat_slab(aes(x = .epred, color = Origin_transplantrl3, fill = Origin_transplantrl3), point_interval=median_hdi, slab_alpha = .4) + #use relevel only because then blue is on top.
stat_pointinterval(aes(x = .epred, color = Origin_transplantrl2, fill = Origin_transplantrl2), #use relevel 2 so in correct order
.width=c(.9, .7), position = position_dodge(width = .3, preserve = "single"), shape = 24) +
scale_color_manual(values = c("#0067A5", "#A1CAF1", "#F99379", "#BE0032"),
name = "",
breaks=c("birdy_birdy",  "ratty_birdy", "birdy_ratty",  "ratty_ratty"),
labels=c("seabird to seabird", "rat to seabird", "seabird to rat", "rat to rat"))+
scale_fill_manual(values = c("#0067A5", "#A1CAF1", "#F99379", "#BE0032"),
name = "",
breaks=c("birdy_birdy",  "ratty_birdy", "birdy_ratty",  "ratty_ratty"),
labels=c("seabird to seabird", "rat to seabird", "seabird to rat", "rat to rat")
)+ #light blue = #A1CAF1, light red/pink = #F99379, orange = #F38400, purple = #875692
xlab(expression(paste("coral growth rate (log cm"^"2"*"year"^"-1"*")")))+
scale_y_continuous(lim=c(-.15,1), breaks = c(0, .5,  1.0))+
ylab("posterior probability")+
theme_bw() +
theme(panel.grid.major = element_blank(), # remove gridlines
panel.grid.minor = element_blank(), #remove gridlines
strip.background = element_blank(),
legend.position = c(.8, .88),
# legend.title=element_blank(),
rect = element_rect(fill = "transparent"),
plot.background = element_rect(fill = "transparent", color = NA))
rte_growth_group_estimates_plot
#make sure have both brms models:
natural_growth_mod_log<-readRDS("../output/brms/natural_growth_mod_log.RDS")
rte_gr_mod_log<-readRDS("../output/brms/rte_gr_mod_log.RDS")
natural_growth_mod_log
natural_growth_mod_log.rg <- update(ref_grid(natural_growth_mod_log), tran = "log")
rte_gr_mod_log
rte_gr_mod_log.rg <- update(ref_grid(rte_gr_mod_log), tran = "log")
#get estimates and HPDs for both natural and rte:
nat_pred_gr_7<-natural_growth_mod_log.rg%>%
emmeans("Treatmentrl",
by=c("Previous_surface_area_cs"),
type="response")%>%
contrast("trt.vs.ctrl", level = .7)%>%
as.data.frame()
nat_pred_gr_9<-natural_growth_mod_log.rg%>%
emmeans("Treatmentrl",
by=c("Previous_surface_area_cs"),
type="response")%>%
contrast("trt.vs.ctrl", level = .9)%>%
as.data.frame()
rte_origin_pred_gr_7<-rte_gr_mod_log.rg%>%
emmeans("Origin_treatmentrl",
by=c("Previous_surface_area_cs"),
type="response")%>%
contrast("trt.vs.ctrl", level = .7)%>%
as.data.frame()
rte_origin_pred_gr_9<-rte_gr_mod_log.rg%>%
emmeans("Origin_treatmentrl",
by=c("Previous_surface_area_cs"),
type="response")%>%
contrast("trt.vs.ctrl", level = .9)%>%
as.data.frame()
rte_trans_pred_gr_7<-rte_gr_mod_log.rg%>%
emmeans("Transplant_treatmentrl",
by=c("Previous_surface_area_cs"),
type="response")%>%
contrast("trt.vs.ctrl", level = .7)%>%
as.data.frame()
rte_trans_pred_gr_9<-rte_gr_mod_log.rg%>%
emmeans("Transplant_treatmentrl",
by=c("Previous_surface_area_cs"),
type="response")%>%
contrast("trt.vs.ctrl", level = .9)%>%
as.data.frame()
nat_pred_gr_7
nat_pred_gr_9
rte_origin_pred_gr_7
rte_origin_pred_gr_9
rte_trans_pred_gr_7
rte_trans_pred_gr_9
#combine estimates:
rte_nat_pred_est<-data.frame(effect = c( 'origin', 'origin', 'transplant', 'transplant', 'natural', 'natural'),
type = c('experimental', 'experimental', 'experimental', 'experimental', 'natural' , 'natural' ),
ratio = c(rte_origin_pred_gr_7$ratio, rte_origin_pred_gr_7$ratio,
rte_trans_pred_gr_7$ratio, rte_trans_pred_gr_7$ratio,
nat_pred_gr_7$ratio, nat_pred_gr_7$ratio), #effect size is the same regardless of interval, so can use either for these
low = c (rte_origin_pred_gr_9$lower.HPD, rte_origin_pred_gr_7$lower.HPD,
rte_trans_pred_gr_9$lower.HPD, rte_trans_pred_gr_7$lower.HPD,
nat_pred_gr_9$lower.HPD, nat_pred_gr_7$lower.HPD),
up = c( rte_origin_pred_gr_9$upper.HPD, rte_origin_pred_gr_7$upper.HPD,
rte_trans_pred_gr_9$upper.HPD, rte_trans_pred_gr_7$upper.HPD,
nat_pred_gr_9$upper.HPD, nat_pred_gr_7$upper.HPD),
level = c( .9, .7, .9, .7, .9, .7))
rte_nat_pred_est
growth_emmeans_effect_plot<-
rte_nat_pred_est %>%
mutate(effect = fct_relevel(effect, c("origin", "transplant", "natural")))%>%
ggplot(aes(x = effect, y = ratio,fill = after_stat(abs(x) > 1), color = after_stat(abs(x) > 1)))+
geom_hline(yintercept=1, lty=2, alpha = .8, color = "#BE0032")+
geom_errorbar(aes(ymin = low, ymax = up), width = 0, size = c(1,2, 1, 2, 1, 2), alpha = .7)+
geom_point(aes(shape = type), size =5, alpha = .9)+
scale_color_manual(values = c("darkgray", "#0067A5"))+ #0067A5 #A1CAF1
scale_fill_manual(values = c("darkgray", "#0067A5"))+ #0067A5 #A1CAF1
scale_shape_manual(values = c(24, 21),
name = "",
breaks=c("experimental",  "natural"),
labels=c("experimental colony", "natural colony"))+
xlab("")+ #xlab("seabird vs. rat")+
guides(fill = "none", color = "none", size = "none") +
scale_x_discrete(labels = c("origin treatment\n(seabird vs rat)", "transplant treatment\n(seabird vs rat)", "natural\n(seabird vs rat)"))+
ylab("multiplicative effect of seabirds on coral growth")+
theme_bw() +
theme(panel.grid.major = element_blank(), # remove gridlines
panel.grid.minor = element_blank(), #remove gridlines
strip.background = element_blank(),
legend.position = c(.3,.9),
rect = element_rect(fill = "transparent"),
plot.background = element_rect(fill = "transparent", color = NA))
growth_emmeans_effect_plot
library(tidyverse)
library(vegan)
library(cowplot)
library(lme4)
library(brms)
library(car)
library(jtools)
library(tidybayes)
library(emmeans)
#size data:----
load("../data/R_data/coral_size_distn_2021.Rdata")
acrop_size_21_dat_dens
coral_size_21_dat_dens
#set prior:
acrop_size_pr<-
set_prior("normal(2, 1)", class = "Intercept") + #based on mean growth from previous studies = 4, along with max and min
set_prior("normal(0, 1)", class = "b")
#run model:
acrop_size_mod<-
brm(bf(log(Max_length_cm) ~ Treatment + (1|Atoll/Island),
sigma ~ Treatment + (1|Atoll/Island),
alpha ~ Treatment + (1|Atoll/Island)),
data = acrop_size_21_dat_dens, family = skew_normal(),
iter = 3000, warmup = 1000, chains = 4, cores = 4,
control = list(adapt_delta = 0.999, max_treedepth = 15),
sample_prior="yes",
prior = acrop_size_pr,
file = "../output/brms/acrop_size_mod")
print(acrop_size_mod)
pp_check(acrop_size_mod)
plot(acrop_size_mod, ask = FALSE)
#extract output:
acrop_size_mod.rg <- update(ref_grid(acrop_size_mod), tran = "log") #for median size
#times difference:
acrop_size_mod.rg %>%
emmeans("Treatment",
type="response")%>%
contrast("revpairwise")
#  Ratty / Birdy  1.09      0.74      1.47
#absolute difference (on log scale):
acrop_size_mod.rg %>%
emmeans("Treatment")%>%
contrast("revpairwise")
# Ratty - Birdy   0.0854    -0.256     0.424
#sigma times difference:
acrop_size_mod%>%
emmeans("Treatment", dpar = "sigma", type = "response")%>%
contrast("revpairwise")
#Ratty / Birdy 0.999     0.767      1.24
#sigma absolute difference:
acrop_size_mod%>%
emmeans("Treatment", dpar = "sigma")%>%
contrast("revpairwise")
# Ratty - Birdy -0.00115     -0.25     0.222
#alpha absolute difference:
acrop_size_mod %>%
emmeans("Treatment", dpar = "alpha")%>%
contrast("revpairwise")
# Ratty - Birdy   -1.23     -5.12       2.5
#alpha estimates:
acrop_size_mod %>%
emmeans("Treatment", dpar = "alpha")
# Birdy     -0.0489     -2.93      3.51
# Ratty      -1.2233     -4.61      2.33
#plot:
acrop_size_pred<-
acrop_size_mod   %>%  #acrop_size_mod_skew2 acrop_size_prior_mod acrop_size_mod
emmeans(~ Treatment,
epred = TRUE,
re_formula = NA) %>%
gather_emmeans_draws()
acrop_size_distn_plot<-
acrop_size_pred %>%
mutate(.value = exp(.value))%>%
ggplot(aes(x = .value, y = 1, color = Treatment, fill = Treatment)) +
stat_halfeye(point_interval=median_hdi,  .width=c(.9, .7),  fatten_point = 2, slab_alpha = 0.6) +
# geom_vline(xintercept = 0, linetype = "dashed") +
theme_bw() +
scale_x_continuous(trans = "log10", limits = c(0.5, 200)) +
ylab("posterior density")+
xlab("log Acropora colony size")+
# xlim(c(0,100))+ ##lots of draws containing extreme values**
theme(panel.grid.major = element_blank(), # remove gridlines
panel.grid.minor = element_blank(), #remove gridlines
strip.background = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
legend.position = c(.3, .9),
rect = element_rect(fill = "transparent"),
plot.background = element_rect(fill = "transparent", color = NA),
text=element_text(size=16,  family="Arial")) +
scale_color_manual(values = c("#0067A5",  "#BE0032"),
guide = "none")+
scale_fill_manual(values = c("#0067A5", "#BE0032"),
name = "",
breaks=c("Birdy",  "Ratty"),
labels=c("seabird islands", "rat islands"))
acrop_size_distn_plot
#set prior:
coral_size_pr<-
set_prior("normal(2.4, 1)", class = "Intercept") + #based on previous studies, mean log(size) = 2.4
set_prior("normal(0, 1)", class = "b")
#run model:
coral_size_mod<-
brm(bf(log(Max_length_cm)  ~ Treatment + (1|Atoll/Island),
sigma ~ Treatment + (1|Atoll/Island),
alpha ~ Treatment + (1|Atoll/Island)),
data = coral_size_21_dat_dens, family = skew_normal(),
iter = 3000, warmup = 1000, chains = 4, cores = 4,
control = list(adapt_delta = 0.999, max_treedepth = 15),
init = 0, prior = coral_size_pr,
sample_prior="yes",
file = "../output/brms/coral_size_mod")
print(coral_size_mod) #only 1 divergent trans - go with it!!!
pp_check(coral_size_mod)
plot(coral_size_mod, ask = FALSE)
#extract output:
coral_size_mod.rg <- update(ref_grid(coral_size_mod), tran = "log") #for median size
#median times difference:
coral_size_mod.rg %>%
emmeans("Treatment",
type="response")%>% #
contrast("revpairwise")
# Ratty - Birdy    1.03      0.65       1.5
#absolute difference (on log scale):
coral_size_mod.rg %>%
emmeans("Treatment")%>% #
contrast("revpairwise")
# Ratty - Birdy    0.0297    -0.371      0.45
#sigma difference:
coral_size_mod %>%
emmeans("Treatment", dpar = "sigma")%>%
contrast("revpairwise")
#Ratty - Birdy    0.0291     -0.17     0.214
#sigma times difference:
coral_size_mod %>%
emmeans("Treatment", dpar = "sigma", type = "response")%>%
contrast("revpairwise")
#Ratty / Birdy  1.03     0.844      1.24
#alpha difference:
coral_size_mod %>%
emmeans("Treatment", dpar = "alpha")%>%
contrast("revpairwise")
# Ratty - Birdy    -0.622     -2.64      1.58
#alpha estimates:
coral_size_mod %>%
emmeans("Treatment", dpar = "alpha")
# Birdy     0.6830     -1.40      2.82
# Ratty     0.0717     -2.03      2.11
#plot:
coral_size_pred<-
coral_size_mod   %>%
emmeans(~ Treatment,
epred = TRUE,
re_formula = NA) %>%
gather_emmeans_draws()
coral_size_distn_plot<-
coral_size_pred %>%
mutate(.value = exp(.value))%>%
ggplot(aes(x = .value, y = 1, color = Treatment, fill = Treatment)) +
stat_halfeye(point_interval=median_hdi, .width=c(.9, .7), fatten_point = 2, slab_alpha = 0.6) +
# geom_vline(xintercept = 0, linetype = "dashed") +
theme_bw() +
scale_x_continuous(trans = "log10", limits = c(0.5, 200)) +
ylab("posterior density")+
xlab("log coral colony size")+
# xlim(c(0,100))+ ##lots of draws containing extreme values**
theme(panel.grid.major = element_blank(), # remove gridlines
panel.grid.minor = element_blank(), #remove gridlines
strip.background = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
legend.position = c(.3, .9),
rect = element_rect(fill = "transparent"),
plot.background = element_rect(fill = "transparent", color = NA),
text=element_text(size=16,  family="Arial")) +
scale_color_manual(values = c("#0067A5",  "#BE0032"),
guide = "none")+
scale_fill_manual(values = c("#0067A5", "#BE0032"),
name = "",
breaks=c("Birdy",  "Ratty"),
labels=c("seabird islands", "rat islands"))
coral_size_distn_plot
